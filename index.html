<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inyecciones Cyber Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { 
            height: 100%; overflow: auto; 
            font-family: 'Orbitron', monospace; background: #0a0a0a; color: #e0e0e0; 
            padding: 0.75rem; display: flex; flex-direction: column; gap: 0.75rem; font-size: 15px; 
        }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at 30% 80%, rgba(200,0,100,0.08) 0%, transparent 50%),
                        radial-gradient(circle at 70% 30%, rgba(0,200,255,0.08) 0%, transparent 50%);
            z-index: -1; animation: cyberPulse 10s ease-in-out infinite alternate; pointer-events: none;
        }
        @keyframes cyberPulse { 0%,100% { opacity: 0.7; } 50% { opacity: 1; } }

        .glass { 
            background: rgba(18, 18, 22, 0.6); backdrop-filter: blur(18px); 
            border: 1px solid rgba(255, 30, 80, 0.35); 
            box-shadow: 0 8px 32px rgba(0,0,0,0.7), inset 0 1px 0 rgba(255,255,255,0.08);
            border-radius: 16px; position: relative; overflow: hidden; transition: all 0.3s;
        }
        .glass::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 2px;
            background: linear-gradient(90deg, transparent, #ff1a5c, transparent); animation: shimmer 3s infinite;
        }
        @keyframes shimmer { 100% { left: 100%; } }
        .glass:hover { transform: translateY(-1px); box-shadow: 0 12px 40px rgba(255,30,80,0.25); }

        .header { text-align: center; padding: 1rem; font-size: 1.1rem; color: #fff; 
            text-shadow: 0 0 12px #ff1a5c; background: rgba(20,8,15,0.85); }

        .params { 
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 0.75rem; 
            padding: 1rem; max-height: 28vh; overflow-y: auto; 
        }
        .param { display: flex; flex-direction: column; gap: 0.25rem; }
        label { font-size: 0.75rem; opacity: 0.85; letter-spacing: 0.5px; }
        input, select { 
            padding: 0.75rem 0.5rem; border: 1px solid rgba(255,255,255,0.12); border-radius: 8px; 
            background: rgba(12,12,15,0.8); color: #fff; font-size: 14px; 
        }
        input:focus, select:focus { box-shadow: 0 0 0 2px rgba(255,30,80,0.4); }
        .freq-buttons { display: flex; gap: 0.25rem; flex-wrap: wrap; }
        button { 
            flex: 1; padding: 0.75rem 0.5rem; border: none; border-radius: 8px; 
            background: linear-gradient(135deg, #ff1a5c, #ff4d88); font-weight: 600; 
            font-size: 13px; cursor: pointer; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            transition: all 0.2s;
        }
        button:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(255,30,80,0.4); }
        button.active { background: linear-gradient(135deg, #00ff88, #00cc66); }
        .preset-list { 
            grid-column: 1 / -1; display: grid; grid-template-columns: repeat(auto-fill, minmax(115px, 1fr)); 
            gap: 0.5rem; padding: 0.75rem 0; max-height: 14vh; overflow-y: auto;
        }
        .preset-btn { padding: 0.6rem; font-size: 11px; background: rgba(255,30,80,0.2); font-weight: 500; }

        .syringe-container { padding: 1.25rem 1rem; text-align: center; flex-shrink: 0; }
        .syringe { 
            width: 95%; max-width: 260px; height: 160px; margin: 0 auto 0.75rem; position: relative; 
            border-radius: 45px 45px 18px 18px; overflow: hidden; background: linear-gradient(180deg, #f8f8f8 0%, #d8d8d8 100%);
            border: 4px solid #282828; box-shadow: 0 12px 30px rgba(0,0,0,0.7), inset 0 2px 0 rgba(255,255,255,0.3);
        }
        .liquid { 
            position: absolute; bottom: 0; left: 12%; right: 12%; /* Margen realista jeringa */
            border-radius: 0 0 14px 14px; height: 0; transition: height 0.4s ease-out;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.3), 0 2px 8px rgba(0,0,0,0.4);
        }
        .needle { 
            position: absolute; top: -18px; left: 50%; transform: translateX(-50%); 
            width: 4px; height: 36px; background: linear-gradient(180deg, #555, #1a1a1a); 
            border-radius: 0 0 2px 2px; box-shadow: 0 0 8px rgba(255,30,80,0.5);
        }
        .volume-text { 
            font-size: 1.3rem; font-weight: 700; margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ff1a5c, #fff); -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; text-shadow: 0 0 12px rgba(255,30,80,0.4);
        }
        .substances { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; padding: 0.5rem 0; }
        .sub-item { 
            display: flex; align-items: center; gap: 0.4rem; padding: 0.5rem 0.75rem; font-size: 0.85rem;
            background: rgba(255,30,80,0.2); border: 1px solid rgba(255,30,80,0.3); border-radius: 18px;
        }
        .color-dot { width: 12px; height: 12px; border-radius: 50%; box-shadow: 0 0 8px currentColor; }

        .checklist { padding: 1rem; flex: 1; max-height: 25vh; overflow-y: auto; }
        .checklist h3 { color: #fff; margin-bottom: 1rem; font-size: 1rem; text-shadow: 0 0 10px #ff1a5c; }
        .check-item { 
            display: flex; align-items: center; gap: 0.75rem; padding: 0.875rem; margin-bottom: 0.5rem;
            background: rgba(35,35,45,0.7); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px;
        }
        input[type=checkbox] { width: 1.3rem; height: 1.3rem; accent-color: #ff1a5c; }

        @media (max-width: 420px) { 
            body { padding: 0.5rem; gap: 0.5rem; font-size: 14px; } 
            .params { grid-template-columns: 1fr; }
            .preset-list { grid-template-columns: repeat(2,1fr); }
            .syringe { height: 140px; }
        }
    </style>
</head>
<body>
    <div class="header glass">üî• CYBER INYECCIONES <span id="cycleName">Ciclo 1</span></div>
    
    <div class="params glass">
        <div class="param">
            <label>üß™ Sustancia</label>
            <select id="substanceSelect"></select>
        </div>
        <div class="param">
            <label>‚öóÔ∏è mg/ml</label>
            <input type="number" id="concentration" placeholder="250">
        </div>
        <div class="param">
            <label>üìä Dosis sem</label>
            <input type="number" id="weeklyDose" placeholder="500">
        </div>
        <div class="param">
            <label>‚è∞ Frec</label>
            <div class="freq-buttons">
                <button class="freq-btn active" data-freq="twice">2x</button>
                <button class="freq-btn" data-freq="eod">EOD</button>
                <button class="freq-btn" data-freq="daily">Dia</button>
            </div>
        </div>
        
        <div class="preset-list">
            <button class="preset-btn" onclick="loadPreset('Test E')">Test E</button>
            <button class="preset-btn" onclick="loadPreset('Deca')">Deca</button>
            <button class="preset-btn" onclick="loadPreset('Tren E')">Tren E</button>
            <button class="preset-btn" onclick="loadPreset('Masteron')">Masteron</button>
            <button class="preset-btn" onclick="loadPreset('Primo')">Primo</button>
            <button class="preset-btn" onclick="loadPreset('Eq')">Eq</button>
            <button class="preset-btn" onclick="loadPreset('NPP')">NPP</button>
            <button class="preset-btn" onclick="loadPreset('Test P')">Test P</button>
            <button class="preset-btn" onclick="loadPreset('Boldenone')">Bold</button>
            <button class="preset-btn" onclick="loadPreset('DHB')">DHB</button>
            <button class="preset-btn" onclick="loadPreset('Anadrol')">Anadrol</button>
            <button class="preset-btn" onclick="loadPreset('Dianabol')">Dbol</button>
        </div>
        <button onclick="addSubstance()" style="grid-column: 1 / -1; padding: 1rem; font-size: 1rem;">üíâ A√ëADIR</button>
    </div>

    <div class="syringe-container glass">
        <div class="syringe" id="syringe"><div class="needle"></div></div>
        <div class="volume-text" id="volumeText">0.00 ml</div>
        <div class="substances" id="substancesList"></div>
    </div>

    <div class="checklist glass">
        <h3>üìã Hoy <span id="todayDate"></span></h3>
        <div id="checklist">A√±ade compuestos arriba</div>
    </div>

    <script>
        // Presets (mismos que antes)
        const PRESETS = {
            'Test E': {name:'Testosterona Enantato', conc:250, dose:500, freq:'twice'},
            'Deca': {name:'Deca Durabolin', conc:200, dose:400, freq:'twice'},
            'Tren E': {name:'Trenbolona Enantato', conc:200, dose:300, freq:'twice'},
            'Masteron': {name:'Masteron', conc:100, dose:400, freq:'eod'},
            'Primo': {name:'Primobolan', conc:100, dose:400, freq:'twice'},
            'Eq': {name:'Equipoise', conc:300, dose:600, freq:'twice'},
            'NPP': {name:'NPP', conc:100, dose:300, freq:'eod'},
            'Test P': {name:'Test Propionato', conc:100, dose:100, freq:'eod'},
            'Boldenone': {name:'Boldenona', conc:200, dose:400, freq:'twice'},
            'DHB': {name:'DHB', conc:100, dose:400, freq:'eod'},
            'Anadrol': {name:'Anadrol', conc:50, dose:50, freq:'daily'},
            'Dianabol': {name:'Dianabol', conc:50, dose:40, freq:'daily'}
        };

        let substances = JSON.parse(localStorage.getItem('substances')) || [];
        let currentCycle = localStorage.getItem('currentCycle') || 'Ciclo 1';
        let nextColorHue = 0;
        const cyberHues = [0, 25, 335, 195, 115, 295, 65, 175];

        function getUniqueColor() {
            const hue = cyberHues[nextColorHue % cyberHues.length];
            nextColorHue++;
            return `hsl(${hue}, 75%, 52%)`;
        }

        function saveData() { localStorage.setItem('substances', JSON.stringify(substances)); }

        function updateSubstanceSelect() {
            document.getElementById('substanceSelect').innerHTML = 
                '<option value="">Nueva...</option>' + substances.map((s,i)=>`<option value="${i}">${s.name}</option>`).join('');
        }

        function loadPreset(key) {
            const p = PRESETS[key];
            document.getElementById('concentration').value = p.conc;
            document.getElementById('weeklyDose').value = p.dose;
            document.querySelector(`[data-freq="${p.freq}"]`).click();
        }

        function calculateInjection() {
            const now = new Date();
            document.getElementById('todayDate').textContent = now.toLocaleDateString('es-ES',{weekday:'short'});
            const dayOfWeek = now.getDay();
            let totalVol = 0, liquids = [];

            substances.forEach(s => {
                const weekly = parseFloat(s.weeklyDose) || 0;
                const injWeek = s.freq === 'daily' ? 7 : s.freq === 'eod' ? 3.5 : 2;
                const doseInj = weekly / injWeek;
                const volInj = doseInj / (parseFloat(s.concentration) || 1);

                let today = false;
                if (s.freq === 'daily') today = true;
                else if (s.freq === 'eod') today = now.getDate() % 2 === 1;
                else if (s.freq === 'twice') today = dayOfWeek === 1 || dayOfWeek === 4;

                if (today) {
                    totalVol += volInj;
                    liquids.push({name:s.name, vol:volInj.toFixed(2), color:s.color});
                }
            });

            updateSyringe(totalVol, liquids);
            updateChecklist(liquids);
        }

        function updateSyringe(totalVol, liquids) {
            const syringe = document.getElementById('syringe');
            const volText = document.getElementById('volumeText');
            const list = document.getElementById('substancesList');

            const syringeSize = totalVol <= 0.25 ? 0.3 : totalVol <= 0.6 ? 0.5 : 1.0;
            volText.textContent = `${totalVol.toFixed(2)} ml (${syringeSize}ml)`;

            syringe.innerHTML = '<div class="needle"></div>';
            let cumulative = 0;
            liquids.forEach(l => {
                if (totalVol > 0) {
                    const pct = (parseFloat(l.vol) / totalVol) * 75; // M√°x 75% altura realista
                    const div = document.createElement('div');
                    div.className = 'liquid';
                    div.style.height = `${Math.min(pct, 75)}%`;
                    div.style.background = l.color;
                    div.style.bottom = `${cumulative}%`;
                    syringe.appendChild(div);
                    cumulative += pct;
                }
            });

            list.innerHTML = liquids.length ? liquids.map(l=>`
                <div class="sub-item">
                    <div class="color-dot" style="background:${l.color}"></div>${l.name}: ${l.vol}ml
                </div>`).join('') : '<div style="opacity:0.6;">Sin inyecci√≥n hoy</div>';
        }

        function updateChecklist(liquids) {
            const checklist = document.getElementById('checklist');
            checklist.innerHTML = liquids.length ? liquids.map(l=>{
                const id = l.name.replace(/[^a-z]/gi,'_');
                return `<div class="check-item">
                    <input type="checkbox" id="${id}" onchange="saveData()">
                    <label for="${id}">${l.name} ${l.vol}ml</label>
                </div>`;
            }).join('') : '<div style="opacity:0.6;text-align:center;">üí§ Hoy libre</div>';
        }

        function addSubstance() {
            const idx = document.getElementById('substanceSelect').value;
            const name = idx ? substances[idx].name : prompt('Nombre:') || 'Nueva';
            const conc = parseFloat(document.getElementById('concentration').value) || 250;
            const dose = parseFloat(document.getElementById('weeklyDose').value) || 500;
            const activeFreq = document.querySelector('.freq-btn.active').dataset.freq;

            const subst = {name, concentration:conc, weeklyDose:dose, freq:activeFreq, color:getUniqueColor()};
            if (idx) substances[idx] = subst; else substances.push(subst);
            
            updateSubstanceSelect(); saveData(); calculateInjection();
            document.getElementById('concentration').value = document.getElementById('weeklyDose').value = '';
        }

        // Init
        document.querySelectorAll('.freq-btn').forEach(b=>b.onclick=()=> {
            document.querySelectorAll('.freq-btn').forEach(x=>x.classList.remove('active'));
            b.classList.add('active');
        });
        document.getElementById('cycleName').textContent = currentCycle;
        updateSubstanceSelect(); calculateInjection();
        setInterval(calculateInjection, 60000);
    </script>
</body>
</html>
