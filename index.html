<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inyecciones Cyber Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Orbitron', -apple-system, monospace; 
            background: #0a0a0a; 
            color: #e0e0e0; 
            min-height: 100vh; padding: 1rem; 
            display: flex; flex-direction: column; gap: 1rem; 
            font-size: 16px; line-height: 1.4;
            overflow-x: hidden;
            position: relative;
        }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(120,0,255,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255,0,120,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(0,255,255,0.05) 0%, transparent 50%);
            z-index: -1; animation: cyberPulse 8s ease-in-out infinite alternate;
        }
        @keyframes cyberPulse {
            0% { opacity: 0.8; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.05); }
        }

        /* Liquid Glass Cyberpunk */
        .glass { 
            background: rgba(20, 20, 25, 0.4); 
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 20, 80, 0.3); 
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.6),
                inset 0 1px 0 rgba(255,255,255,0.1),
                inset 0 -1px 0 rgba(255,0,80,0.2);
            border-radius: 16px; position: relative; overflow: hidden;
        }
        .glass::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer { 100% { left: 100%; } }

        .header { 
            text-align: center; padding: 1.25rem; font-weight: 700; font-size: 1.2rem; 
            color: #fff; text-shadow: 0 0 10px #ff1452;
            background: linear-gradient(135deg, rgba(15,0,30,0.8), rgba(40,0,20,0.6));
        }
        .params { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; 
            padding: 1.25rem; 
        }
        .param { display: flex; flex-direction: column; gap: 0.5rem; }
        input, select, button { 
            padding: 0.875rem; border: 1px solid rgba(255,255,255,0.1); 
            border-radius: 10px; background: rgba(15,15,20,0.6); 
            color: #fff; font-size: 16px; backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        input:focus, select:focus { 
            outline: none; box-shadow: 0 0 0 2px rgba(255,20,80,0.5); 
            background: rgba(30,0,15,0.7);
        }
        button { 
            background: linear-gradient(135deg, #ff1452, #ff4d4d); 
            font-weight: 600; cursor: pointer; border: none;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        button:hover { transform: translateY(-1px); box-shadow: 0 5px 15px rgba(255,20,80,0.4); }
        button.active { background: linear-gradient(135deg, #10b981, #059669); }

        .syringe-container { padding: 1.5rem; text-align: center; }
        .syringe { 
            width: 100%; max-width: 300px; height: 220px; margin: 0 auto 1rem; 
            position: relative; border-radius: 60px 60px 25px 25px; overflow: hidden;
            background: linear-gradient(180deg, rgba(240,240,240,0.9) 0%, rgba(200,200,200,0.8) 100%);
            border: 5px solid #333; box-shadow: 
                0 15px 40px rgba(0,0,0,0.7),
                inset 0 2px 0 rgba(255,255,255,0.3);
        }
        .liquid { 
            position: absolute; bottom: 0; left: 0; right: 0; 
            border-radius: 0 0 25px 25px; height: 0; transition: height 0.4s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .needle { 
            position: absolute; top: -25px; left: 50%; transform: translateX(-50%); 
            width: 5px; height: 50px; background: linear-gradient(180deg, #666, #333); 
            border-radius: 0 0 3px 3px; box-shadow: 0 0 10px rgba(255,20,80,0.5);
        }
        .volume-text { 
            font-size: 1.5rem; font-weight: 800; 
            background: linear-gradient(135deg, #ff1452, #fff); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255,20,80,0.5);
        }
        .substances { display: flex; flex-wrap: wrap; gap: 0.75rem; justify-content: center; margin-top: 1rem; }
        .sub-item { 
            display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; 
            background: rgba(255,20,80,0.15); border: 1px solid rgba(255,20,80,0.3);
            border-radius: 25px; font-size: 0.9rem; backdrop-filter: blur(10px);
        }
        .color-dot { width: 16px; height: 16px; border-radius: 50%; box-shadow: 0 0 10px currentColor; }

        .checklist { padding: 1.25rem; }
        .checklist h3 { color: #fff; margin-bottom: 1rem; text-shadow: 0 0 10px #ff1452; }
        .check-item { 
            display: flex; align-items: center; gap: 1rem; padding: 1rem; 
            background: rgba(40,40,50,0.4); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; margin-bottom: 0.5rem; backdrop-filter: blur(10px);
        }
        input[type=checkbox] { width: 1.5rem; height: 1.5rem; accent-color: #ff1452; }

        @media (max-width: 480px) { 
            body { padding: 0.75rem; gap: 0.75rem; } 
            .params { grid-template-columns: 1fr; }
            .syringe { height: 200px; }
        }
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    </style>
</head>
<body>
    <!-- Mismo HTML que antes, solo cambia el CSS -->
    <div class="header glass"> Inyecciones Cyber - <span id="cycleName">Ciclo Actual</span></div>
    
    <div class="params glass">
        <div class="param">
            <label style="font-size: 0.85rem; opacity: 0.9;">Sustancia</label>
            <select id="substanceSelect"></select>
        </div>
        <div class="param">
            <label style="font-size: 0.85rem; opacity: 0.9;">mg/ml</label>
            <input type="number" id="concentration" placeholder="200" min="1">
        </div>
        <div class="param">
            <label style="font-size: 0.85rem; opacity: 0.9;">Dosis sem (mg)</label>
            <input type="number" id="weeklyDose" placeholder="400" min="1">
        </div>
        <div class="param">
            <label style="font-size: 0.85rem; opacity: 0.9;">Frecuencia</label>
            <div style="display: flex; gap: 0.5rem;">
                <button class="freq-btn" data-freq="daily">Diario</button>
                <button class="freq-btn" data-freq="eod">EOD</button>
                <button class="freq-btn" data-freq="twice">2x/Sem</button>
            </div>
        </div>
        <button onclick="addSubstance()" style="grid-column: span 2; font-size: 1.1rem;"> AADIR</button>
    </div>

    <div class="syringe-container glass">
        <div class="syringe" id="syringe">
            <div class="needle"></div>
        </div>
        <div class="volume-text" id="volumeText">0.0 ml</div>
        <div class="substances" id="substancesList"></div>
    </div>

    <div class="checklist glass">
        <h3> Checklist Hoy</h3>
        <div id="checklist"></div>
    </div>

    <!-- Script igual que antes, sin cambios -->
    <script>
        // [Mismo JavaScript exacto de la versi贸n anterior - no cambia la l贸gica]
        let substances = JSON.parse(localStorage.getItem('substances')) || [];
        let currentCycle = localStorage.getItem('currentCycle') || 'Ciclo 1';
        let nextColorHue = 0;

        function getUniqueColor() {
            const hue = nextColorHue;
            nextColorHue = (nextColorHue + 137) % 360;
            // Paleta cyber: rojo/ne贸n/grises limitados
            const cyberHues = [0, 30, 330, 200, 120, 300]; // Rojo, naranja-rojo, magenta, cian, verde-ne贸n, violeta
            const cyberHue = cyberHues[hue % cyberHues.length];
            return `hsl(${cyberHue}, 80%, 55%)`;
        }

        // ... resto del script id茅ntico (updateSubstanceSelect, calculateInjection, etc.)
        function saveData() {
            localStorage.setItem('substances', JSON.stringify(substances));
            localStorage.setItem('currentCycle', currentCycle);
        }

        function updateSubstanceSelect() {
            const select = document.getElementById('substanceSelect');
            select.innerHTML = '<option value="">Nueva sustancia</option>' + 
                substances.map((s, i) => `<option value="${i}">${s.name}</option>`).join('');
        }

        function calculateInjection() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            let totalVol = 0;
            let liquids = [];

            substances.forEach(s => {
                const weeklyDose = parseFloat(s.weeklyDose) || 0;
                let injectionsPerWeek = s.freq === 'daily' ? 7 : s.freq === 'eod' ? 3.5 : 2;
                const dosePerInj = weeklyDose / injectionsPerWeek;
                const volPerInj = dosePerInj / (parseFloat(s.concentration) || 1);

                let todayInject = false;
                if (s.freq === 'daily') todayInject = true;
                else if (s.freq === 'eod') todayInject = (now.getDate() % 2 === 0);
                else if (s.freq === 'twice') todayInject = (dayOfWeek === 1 || dayOfWeek === 4);

                if (todayInject) {
                    totalVol += volPerInj;
                    liquids.push({ name: s.name, vol: volPerInj.toFixed(2), color: s.color });
                }
            });

            updateSyringe(totalVol, liquids);
            updateChecklist(liquids);
        }

        function updateSyringe(totalVol, liquids) {
            const syringe = document.getElementById('syringe');
            const volumeText = document.getElementById('volumeText');
            const substancesList = document.getElementById('substancesList');

            let syringeSize = '0.3';
            if (totalVol > 0.25) syringeSize = '0.5';
            if (totalVol > 0.45) syringeSize = '1.0';
            volumeText.textContent = `${totalVol.toFixed(2)} ml (${syringeSize}ml)`;

            syringe.querySelectorAll('.liquid').forEach(el => el.remove());

            let cumulativeHeight = 0;
            liquids.forEach(liquid => {
                const height = (liquid.vol / totalVol) * 100 || 0;
                const div = document.createElement('div');
                div.className = 'liquid';
                div.style.height = `${height}%`;
                div.style.backgroundColor = liquid.color;
                div.style.top = `${100 - (cumulativeHeight + height)}%`;
                syringe.appendChild(div);
                cumulativeHeight += height;
            });

            substancesList.innerHTML = liquids.map(l => 
                `<div class="sub-item"><div class="color-dot" style="background:${l.color}"></div>${l.name}: ${l.vol}ml</div>`
            ).join('');
        }

        function updateChecklist(liquids) {
            const checklist = document.getElementById('checklist');
            if (liquids.length === 0) {
                checklist.innerHTML = '<div style="text-align:center; opacity:0.7; padding:1rem;">Hoy no toca </div>';
                return;
            }
            checklist.innerHTML = liquids.map(l => `
                <div class="check-item">
                    <input type="checkbox" id="${l.name.replace(/\s+/g,'_')}" onchange="saveData()">
                    <label for="${l.name.replace(/\s+/g,'_')}">${l.name} (${l.vol}ml)</label>
                </div>
            `).join('');
        }

        function addSubstance() {
            const name = prompt('Nombre de la sustancia:') || `Sust ${substances.length + 1}`;
            const conc = document.getElementById('concentration').value;
            const dose = document.getElementById('weeklyDose').value;
            const freq = document.querySelector('.freq-btn.active')?.dataset.freq || 'daily';

            if (conc && dose) {
                substances.push({
                    name, concentration: conc, weeklyDose: dose, freq,
                    color: getUniqueColor()
                });
                updateSubstanceSelect();
                saveData();
                calculateInjection();
                document.getElementById('concentration').value = '';
                document.getElementById('weeklyDose').value = '';
            }
        }

        document.querySelectorAll('.freq-btn').forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll('.freq-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            };
        });

        document.getElementById('cycleName').textContent = currentCycle;
        updateSubstanceSelect();
        calculateInjection();
        setInterval(calculateInjection, 60000);
    </script>
</body>
</html>
